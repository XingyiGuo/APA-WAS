# Run
Rscript buildmodel.r
python gcta_cojo.py

# Annotations
1. Build model for the APA mark "NM_002035.4|KDSR|chr18|-" using buildmodel.r
  1.1 Input files
    1.1.1 qn_pdui.rds: quantile-normalized PDUI values of "NM_002035.4|KDSR|chr18|-".
    1.1.2 Breast_complete_data_PEER_factors.txt: PEER factors of PDUI values of all APA marks within breast tissue samples.
    1.1.3 Breast_covs.txt: Covariates in addition to PEER factors.
    1.1.4 dosage.rds: Alleic dosage of SNPs within 500Kb flanking region of "NM_002035.4|KDSR|chr18|-".
    1.1.5 snpinfo.rds: Information of SNPs in "dosage.rds", including chromosome, position(hg19), counted allele and other allele.
  1.2 Output files
    1.2.1 extra.csv: Information of prediction R-squared, p value, number of SNPs in model.
    1.2.2 weights.csv: Weigts, effect allele, other allele of SNPs in model.
    1.2.3 cov.txt.gz: Covariance of SNPs in model estimated using breast tissue samples.
    1.2.4 breast.db: R db file requested for SPrediXcan analyses.

2. SPrediXcan, GCTA-COJO, and SPrediXcan after GCTA-COJO
  2.1 Input files for first SPrediXcan analyses
    2.1.1 breast.db: R db file generated by "buildmodel.r"
    2.1.2 gwas.csv: Summary statistics of SNPs in model, extracted from data downloaded from Zhang et al. Nat Genet 2020.
    2.1.3 cov.txt.gz: Covariance generated by "buildmodel.r"
  2.2 Input files for GCTA-COJO analyses
    2.2.1 /scratch/sbcs/yhyang/Refs/Chr18/chr18: Plink bfiles of chr18 of 1000 Genomes European participants
    2.2.2 rsid: rs number of SNPs in model and rs17743054, the GWAS-identified index SNP which is closest to "NM_002035.4|KDSR|chr     18|-". 18:60991409:AAAAG:A could not be found in 1000 Genomes data.
    2.2.3 predictingSNP_indexSNP.ss: summary statistics of SNPs in model and rs17743054
    2.2.4 cond.snp: rs17743054, whichi needs to be adjusted in GCTA-COJO analyses.
  2.3 Output files
    2.3.1 assoc.csv: Results from first step SPrediXcan, i.e. Association of "NM_002035.4|KDSR|chr18|-" with breast cancer.
    2.3.2 cojores.cma.cojo: summary statistics of model SNPs conditioning on rs17743054.
    2.3.3 cojores.gwas: input file for second step SPrediXcan, generated according to cojores.cma.cojo.
    2.3.4 cojores.assoc.csv: Results from second step SPrediXcan, i.e. Association of "NM_002035.4|KDSR|chr18|-" with breast cancer    , conditioning on rs17743054.
